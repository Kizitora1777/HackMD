###### tags: `卒業研究`

# 卒業論文 アウトライン

5409 遠藤 拓斗

## タイトル(仮)

プライバシー保護機械学習における準同型除算を用いたシグモイド関数の検討

キーワード：プライバシー保護機械学習, 準同型除算, シグモイド関数

memo: NNの要素を入れる。例：プライバシー保護機械学習のニューラルネットワークにおけるシグモイド関数

## 第1章 はじめに

### 研究背景

プライバシー保護機械学習の背景
+ 機械学習をクラウド上で行いたい
+ 機密データを使う場合、セキュリティ上のリスクがある
+ データを暗号化したまま学習できるようにしたい。これを実現する手法はいくつかあるが、今回は完全準同型暗号(FHE)を使う

ニューラルネットワーク

### 最終目標

活性化関数で暗号化したデータを処理する際に、近似せずに使えることが望ましい
+ 近似による誤差を減らし精度を向上

**順番おかしい？先に直接近似の話を入れないと流れが分かりにくい？**

### 現状

しかし、FHEで効率的に演算できるのは加算と乗算のみ。そのため、活性化関数を近似する必要がある
+ 近似誤差による精度低下のリスク
+ 近似する必要がある活性化関数の例
    + シグモイド関数：除算・$\exp(x)$が演算できない
    + ReLU：比較が演算できない
+ 活性化関数の直接近似(関連手法)

### 課題

活性化関数を近似手法なしで演算できるようにし、近似誤差による精度低下を防ぐ
+ 今回は活性化関数の中でもシグモイド関数をターゲットとする

### 問題

シグモイド関数を直接近似しない場合、除算・$\exp(x)$を加算と乗算のみで実現する必要がある
+ この2つの演算を加算と乗算で構成できれば、シグモイド関数を実現できる

### 目的

そこでシグモイド関数に必要な除算を提案し、関数を部分的に実現する
+ $\exp(x)$については先行研究で提案されている
+ 準同型除算を用いたシグモイド関数は、先行研究でも提案されていない
    + 先行研究は直接近似する手法を使っている

### 目標

具体的には

①指数関数

②除算

③シグモイド関数

### 手段

そのためには

①先行研究の手法

②スケーリングしたうえで多項式補間で近似

③①と②を用いて構成する

## 1.5(?) 関連研究

+ 直接近似 CryptoDL, PPML ResNet20, Sealion
+ 除算：ゴールドシュミット除算

## 第2章 周辺技術

+ 公開鍵暗号
+ 準同型暗号
+ 完全準同型暗号
+ CKKS
+ HELib
+ 多項式補間

## 3. 提案手法

### 指数関数の近似手法

+ 先行研究のアルゴリズム
    + 先行研究の提案手法を説明する
+ スケーリング
    + 入力値を$B$で割ることで$[-1, 1]$の範囲に抑える
+ $y = \exp(x) \ \{-1 \leq x \leq 1\}$ の多項式近似
    + 近似手法について説明する

### 除算の近似手法

+ アルゴリズム
    + 今回新たに提案した手法を説明する
+ スケーリング
    + 入力値を$R$で割ることで$[1, 10]$の範囲に抑える
+ $y = \frac{1}{x} \ \{1 \leq x \leq 10 \}$ の多項式近似
    + 近似手法について説明する

### シグモイド関数の構成

+ アルゴリズム
    + 3.1の指数関数と3.2の除算による構成を説明する

## 4. 実装

### 指数関数の実装

+ ソースコードと解説

### 除算の実装

+ ソースコードと解説

### シグモイド関数の実装

+ ソースコードと解説

## 5. 実験と評価

### 指数関数の結果

+ 図表
    + 真値と近似値の比較グラフ
    + **近似誤差を値として示さないとダメ**
<img src="https://i.imgur.com/HOd3tCg.png" width="80%">
+ 知見の得方
    + 真値と近似式の差を確認する
+ 得られた知見
    + $\exp(x)$を高精度で近似できる
    + 先行研究の通りに実現できた

### 除算の結果

+ 図表
    + 真値と近似値の比較グラフ
    + **近似誤差を値として示さないとダメ**
<img src="https://i.imgur.com/rvze7hy.png" width="80%">

+ 知見の得方
    + 真値と近似式の差を確認する
+ 得られた知見
    + 除算$y = 1/x$を高精度で近似できる
    + $1 \leq x$ の値の逆数を求められる
    + 多項式補間を整数から実数へ拡張できる

### シグモイド関数の結果

+ 図表
    + 乗算の深さ - オーダー記法
    + 平文のMNISTデータセットに対して、通常のシグモイド関数と近似式でそれぞれの精度を検証した表

| 活性化関数 | 損失値              | 精度               |
| ---------- | ------------------- | ------------------ |
| シグモイド | 0.1018 | 0.9699 |
| 近似式 | 0.1033 | 0.9696 |

+ 知見の得方
    + 平文データに対するシグモイド関数と近似式の精度の違い
    + オーダー記法をもとに計算量を読み取る
+ 得られた知見
    + 近似による精度の低下は最小限
    + 乗算の深さをもとに、FHEのパラメータを見積もれる

## 6. 考察

### 研究の進捗状況

+ 新たに提案したシグモイド関数の精度
    + 近似式を使ってシグモイド関数と同程度の精度が得られた
+ 従来とは異なるシグモイド関数の近似
    + 本研究で新たに除算を構成したことで、直接近似する方法とは異なるアプローチで計算できる

### 研究によって新たに得られた情報
+ 指数関数
    + 先行研究で述べられていた手法を再度実現できた
+ 除算
    + 従来の多項式補間による手法は整数を対象としていたが、今回は実数にも適用できる
+ シグモイド関数
    + シグモイド関数の入力値は指数関数の入力範囲$[-B, B]$と同じ
### 今後に向けて
+ 精度検証
    + 暗号データに対する評価も行う必要がある
### 現状の課題
+ 除算のスケーリングの算出
    + $R = a^{\lfloor \log_a x \rfloor}$ がFHEだと計算できない

## 7. まとめ

### 研究目的の再提示
+ シグモイド関数に必要な除算を提案し、それを用いてシグモイド関数を構成する

### 攻略の肝・進捗
+ シグモイド関数に必要な除算を提案した
+ この手法でシグモイド関数を構成した

### 懸念・弱点
+ スケーリング $R = a^{\lfloor \log_a x \rfloor}$ を計算するために復号する必要がある

### 本研究の新規性
+ 直接近似とは異なるアプローチでシグモイド関数を構築した
+ 通常のシグモイド関数と同精度の近似が実現できた

### 今後の課題
+ 暗号データに対する精度検証が必要